<!DOCTYPE html>
<html lang="pt-br" xmlns:th="<http://www.thymeleaf.org>">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <script src="../../static/script.js"></script>
  <script>
    function limpa_formulário_cep() {
    //Limpa valores do formulário de cep.
    document.getElementById('rua').value = ("");
    document.getElementById('bairro').value = ("");
    document.getElementById('cidade').value = ("");
    document.getElementById('uf').value = ("");
}

function meu_callback(conteudo) {
    if (!("erro" in conteudo)) {
        //Atualiza os campos com os valores.
        document.getElementById('rua').value = (conteudo.logradouro);
        document.getElementById('bairro').value = (conteudo.bairro);
        document.getElementById('cidade').value = (conteudo.localidade);
        document.getElementById('uf').value = (conteudo.uf);
    } //end if.
    else {
        //CEP não Encontrado.
        limpa_formulário_cep();
        alert("CEP não encontrado.");
    }
}

function pesquisacep(valor) {

    //Nova variável "cep" somente com dígitos.
    var cep = valor.replace(/\D/g, '');

    //Verifica se campo cep possui valor informado.
    if (cep != "") {

        //Expressão regular para validar o CEP.
        var validacep = /^[0-9]{8}$/;

        //Valida o formato do CEP.
        if (validacep.test(cep)) {

            //Preenche os campos com "..." enquanto consulta webservice.
            document.getElementById('rua').value = "...";
            document.getElementById('bairro').value = "...";
            document.getElementById('cidade').value = "...";
            document.getElementById('uf').value = "...";

            //Cria um elemento javascript.
            var script = document.createElement('script');

            //Sincroniza com o callback.
            script.src = 'https://viacep.com.br/ws/' + cep + '/json/?callback=meu_callback';

            //Insere script no documento e carrega o conteúdo.
            document.body.appendChild(script);

        } //end if.
        else {
            //cep é inválido.
            limpa_formulário_cep();
            alert("Formato de CEP inválido.");
        }
    } //end if.
    else {
        //cep sem valor, limpa formulário.
        limpa_formulário_cep();
    }
};

  </script>
  <title>Cadastrar Cliente</title>
</head>
<body>
  <nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
      <a href="#" class="navbar-brand">Página Home :)</a>
    </div>
  </nav>

  <main class="container">
    <h1 class="col-md-4 offset-md-4" style="text-align: center;">Adicionar Membro</h1>

    <form style="text-align: center;" class="col align-self-center" method="POST" th:object="${membro}">
        <div class="col-md-4 offset-md-4">
          <label for="name" class="form-label">Nome Completo:</label>
          <input type="text" class="form-control" id="nome" th:field="*{nome}">
          <br>
        </div>
        <div class="col-md-4 offset-md-4">
            <label for="text" class="form-label">Telefone:</label>
            <input type="text" class="form-control" id="numero" th:field="*{numero}">
            <br>
          </div>
          <div class="col-md-4 offset-md-4">
            <label for="date" class="form-label">Data de Nascimento:</label>
            <input type="date" class="form-control" id="dataNasc" th:field="*{dataNasc}">
            <br>
          </div>
          <div class="col-md-4 offset-md-4">
            <label for="email" class="form-label">email:</label>
            <input type="email" class="form-control" id="email" th:field="*{email}">
            <br>
          </div>
          <div class="col-md-4 offset-md-4">
            <label for="date" class="form-label">Senha:</label>
            <input type="password" class="form-control" id="senha" th:field="*{senha}">
            <br>
          </div>
          <div class="col-md-4 offset-md-4">
              <label for="text" class="form-label">CEP:</label>
              <input name="cep" type="text" id="cep" value="" size="10" maxlength="9"
              onblur="pesquisacep(this.value);" th:field="*{cep}"  class="form-control">
              <br>
            </div>
            <div class="col-md-4 offset-md-4">
                <label for="name" class="form-label">Logradouro:</label>
                <input name="rua" type="text" id="rua" th:field="*{logradouro}"  class="form-control" >
                <br>
              </div>
              <div class="col-md-4 offset-md-4">
                <label for="date" class="form-label">Nº:</label>
                <input type="text" class="form-control" id="numEnd" th:field="*{numeroEnd}">
                <br>
              </div>
              <div class="col-md-4 offset-md-4">
                  <label for="text" class="form-label">Complemento:</label>
                  <input type="text" class="form-control" id="complemento" th:field="*{complemento}">
                  <br>
                </div>
                <div class="col-md-4 offset-md-4">
                    <label for="name" class="form-label">Bairro:</label>
                    <input name="bairro" type="text" id="bairro" size="40" th:field="*{bairro}"  class="form-control" >
                    <br>
                  </div>
                  <div class="col-md-4 offset-md-4">
                    <label for="date" class="form-label">UF:</label>
                    <input name="uf" type="text" id="uf" size="2" th:field="*{estado}"  class="form-control" >
                    <br>
                  </div>
                  <div class="col-md-4 offset-md-4">
                      <label for="text" class="form-label">Cidade:</label>
                      <input name="cidade" type="text" id="cidade" size="40" th:field="*{cidade}"  class="form-control" >
                      <br>
                    </div>
        <button type="submit" class="btn btn-primary">Cadastrar</button>
      </form>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
</body>
</html>